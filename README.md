# Training a Lung Cancer Histological Type Classifier Using a Synthetic Dataset Generated by Progressive Growing GAN (PGGAN)

This repository contains the code for a [Bachelor Thesis](https://pcs.usp.br/pcspf/wp-content/uploads/sites/8/2022/12/Monografia_PCS3860_COOP_2022_Grupo_C05.pdf) project that aims to train a classifier to identify the histological type of lung cancer nodules using a synthetic dataset generated by Progressive Growing Generative Adversarial Networks (PGGAN).

# Background
Early detection of the lung cancer subtype is crucial for the prognosis and treatment of the disease, which can significantly increase the survival rate of patients. Currently, subtype detection is done through a biopsy, a time-consuming and highly invasive procedure with potential clinical implications.

# Approach
To circumvent these problems, this work proposes using computed tomography images combined with deep learning (DL) algorithms, specifically convolutional neural networks, to classify the histological type of nodules. However, DL algorithms require a large number of annotated images by a specialist, which can be costly in the case of medical images.

To solve this problem, the use of PGGAN to generate additional synthetic images is proposed to train the classifier and improve its performance.

# Data
Three different datasets were used in this study: [HCFMRP](https://site.hcrp.usp.br/), [LungPET-CT-Dx](https://doi.org/10.7937/TCIA.2020.NNC2-0461), and [NSCLC Radiomics](https://doi.org/10.7937/K9/TCIA.2015.PF0M9REI). Together the datasets contain 3263 images from 205 exams, whose diagnosis was adenocarcinoma and 4274 images from 220 exams, whose diagnosis was squamous carcinoma.

# Results

The results show that the use of PGGAN-generated images improves the performance of the classifier, reaching an accuracy of 0.940 compared to 0.906 for the model trained only with real images, representing a 3.8% improvement.


<p align = "center">
<img src="https://github.com/paulooctavio/lung-nodule-classification-in-CT-images/blob/main/images/grid_adeno.png?raw=true" alt="drawing" width="250"/>
<img src="https://github.com/paulooctavio/lung-nodule-classification-in-CT-images/blob/main/images/grid_squamous.png?raw=true" alt="drawing" width="250"/>
</p>
<p align = "center">
Adenocarcinoma and Squamous cell carcinoma nodules (left to right) generate by the PGGAN.
</p>


# Content
This repository contains the code for training and evaluating both the classifier and the PGGAN. The code is implemented in Python the popular deep learning library [PyTorch](https://pytorch.org/).

# Note
This repository is only for academic purposes and should not be used for any medical decision-making.